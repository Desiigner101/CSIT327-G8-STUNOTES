{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Edit Profile - {{ user.username }}</title>
    <link rel="stylesheet" href="{% static 'notes/css/home.css' %}"> 
    <link rel="stylesheet" href="{% static 'notes/css/edit_profile.css' %}">
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
</head>
<body>
    <aside class="sidebar">
        <div class="logo">StuNotes</div>
        <nav>
            <ul>
                <li><a href="{% url 'notes:home' %}">üè† Home</a></li>
                <li><a href="{% url 'notes:profile_view' %}">üë§ Profile</a></li>
                <li><a href="#">üìÖ Calendar</a></li>
                <li><a href="#">‚öô Settings</a></li>
                <li><a href="{% url 'notes:logout' %}">üö™ Logout</a></li>
            </ul>
        </nav>
        <div class="stats">
            <p>Tasks: <span>21</span></p> 
            <p>Notes: <span>12</span></p>
        </div>
    </aside>

    <main class="main profile-page-content">
        {% if messages %}
            <div class="messages">
                {% for message in messages %}
                    <div class="message-item {% if message.tags %}message-{{ message.tags }}{% endif %}">
                        {{ message }}
                    </div>
                {% endfor %}
            </div>
        {% endif %}

        <div class="profile-card">
            <div class="profile-cover"></div>

            <div class="profile-header">
                <img src="{% if user.profile_pic %}{{ user.profile_pic.url }}{% else %}{% static 'notes/images/default.jpg' %}{% endif %}" 
                     alt="{{ user.username }}" 
                     class="profile-pic">
                
                <div class="user-details">
                    <h2>{{ user.full_name|default:user.username }}</h2>
                    <p class="email-display">{{ user.email }}</p>
                </div>

                <button type="submit" form="profile-form" class="btn-edit btn-save">
                    <i class="fas fa-save"></i> Save Changes
                </button>
            </div>
        </div>
        
        <form method="post" id="profile-form" class="edit-form-container" enctype="multipart/form-data">
            {% csrf_token %}
            
            <div class="form-grid">
                
                <div class="form-group">
                    <label for="{{ form.full_name.id_for_label }}">Full Name</label>
                    {{ form.full_name }}
                    {% for error in form.full_name.errors %} <p class="error-text">{{ error }}</p> {% endfor %}
                </div>
                <div class="form-group">
                    <label for="{{ form.theme.id_for_label }}">App Theme</label>
                    {{ form.theme }}
                    {% for error in form.theme.errors %} <p class="error-text">{{ error }}</p> {% endfor %}
                </div>
                
                <div class="form-group">
                    <label for="{{ form.email.id_for_label }}">Email Address</label>
                    {{ form.email }}
                    {% for error in form.email.errors %} <p class="error-text">{{ error }}</p> {% endfor %}
                </div>
                <div class="form-group">
                    <label for="{{ form.profile_pic.id_for_label }}" class="pic-upload-label">
                        {{ form.profile_pic.label }}
                    </label>
                    {{ form.profile_pic }} 
                    {% for error in form.profile_pic.errors %} <p class="error-text">{{ error }}</p> {% endfor %}
                </div>

                <div class="form-group full-width">
                    <label for="{{ form.bio.id_for_label }}">Bio (Tell us about yourself)</label>
                    {{ form.bio }}
                    {% for error in form.bio.errors %} <p class="error-text">{{ error }}</p> {% endfor %}
                </div>
            </div>

            <div class="email-section">
                <h3>My Primary Email Address</h3>
                <div class="email-display-box">
                    <i class="fas fa-envelope-open-text"></i>
                    <div class="email-details">
                        <span class="email-address">{{ user.email }}</span>
                        <span class="email-status">Primary</span>
                    </div>
                </div>
                <button type="button" class="btn-add-email">+ Add Email Address</button>
            </div>
        </form>
        
    </main>
</body>
</html>